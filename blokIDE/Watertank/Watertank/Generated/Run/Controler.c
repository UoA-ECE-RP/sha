// This file is generated by FBC.

#include "Controler.h"
#include <string.h>
#include <stdio.h>

/* Function block initialization function */
void Controlerinit(Controler* me)
{
    me->_state = 0;
    me->_entered = false;
    me->_input.events = 0;
    me->_output.events = 0;
}

/* ECC algorithms */
void Controler_setON(Controler* me)
{
me->ON=1;
printf("setON\n");


}

void Controler_setOFF(Controler* me)
{
me->OFF=1;
printf("setOFF\n");
}

void Controler_wait(Controler* me)
{
sleep(1);
me->timer=1;



}

void Controler_reset_timer(Controler* me)
{
me->timer=0;

}

void Controler_reset(Controler* me)
{
me->ON=0; me->OFF=0;


}

void Controler_init(Controler* me)
{
me->ON=0; me->OFF=0;
me->timer=0;
me->x=20;


}

/* Function block execution function */
void Controlerrun(Controler* me)
{
    me->_output.events = 0;

    if (me->_input.event.clock) {
        me->x = me->_x;
    }
    for (;;) {
        switch (me->_state) {
            case 0:
                // State: Start
                if (!me->_entered) {
                    Controler_init(me);
                    me->_output.event.update = 1;
                    me->_entered = true;
                }
                else {
                    me->_state = 1;
                    me->_entered = false;
                    continue;
                }
                break;
            case 1:
                // State: Resting
                if (!me->_entered) {
                    Controler_wait(me);
                    me->_output.event.update = 1;
                    me->_entered = true;
                }
                else {
                    if (true && (me->timer == 1)) {
                        me->_state = 2;
                        me->_entered = false;
                        continue;
                    }
                }
                break;
            case 2:
                // State: TURN_ON
                if (!me->_entered) {
                    Controler_setON(me);
                    me->_output.event.update = 1;
                    Controler_reset_timer(me);
                    me->_entered = true;
                }
                else {
                    me->_state = 3;
                    me->_entered = false;
                    continue;
                }
                break;
            case 3:
                // State: HeatingUp
                if (!me->_entered) {
                    Controler_reset(me);
                    me->_output.event.update = 1;
                    me->_entered = true;
                }
                else {
                    if (true && (me->x >= 100)) {
                        me->_state = 4;
                        me->_entered = false;
                        continue;
                    }
                }
                break;
            case 4:
                // State: Boiling
                if (!me->_entered) {
                    Controler_wait(me);
                    me->_output.event.update = 1;
                    me->_entered = true;
                }
                else {
                    if (true && (me->timer == 1)) {
                        me->_state = 5;
                        me->_entered = false;
                        continue;
                    }
                }
                break;
            case 5:
                // State: TURN_OFF
                if (!me->_entered) {
                    Controler_reset_timer(me);
                    me->_output.event.update = 1;
                    Controler_setOFF(me);
                    me->_entered = true;
                }
                else {
                    me->_state = 6;
                    me->_entered = false;
                    continue;
                }
                break;
            case 6:
                // State: CooolingDown
                if (!me->_entered) {
                    Controler_reset(me);
                    me->_output.event.update = 1;
                    me->_entered = true;
                }
                else {
                    if (true && (me->x <= 20)) {
                        me->_state = 1;
                        me->_entered = false;
                        continue;
                    }
                }
                break;
        }
        break;
    }
    if (me->_output.event.update) {
        me->_ON = me->ON;
        me->_OFF = me->OFF;
    }

    me->_input.events = 0;
}

